<% include partials/filter_header %>

<%

let genres = ['Action', 'Indie', 'Adventure', 'RPG', 'Shooter', 'Strategy', 'Casual', 'Simulation', 'Puzzle', 'Arcade', 'Platformer', 'Racing', 'Sports','Massively Multiplayer', 'Family', 'Fighting', 'Board Games', 'Educational', 'Card'];
let platforms = ['PC', 'Playstation 4', 'Xbox One', 'Nintendo Switch'];

%>

<div class="col-sm-2" id="filter">
    <h1 class="mt-4">Filters</h1>
    <hr>
    <form method="get">

        <div class="collapse" id="collapsegenre" aria-expanded="false">
            <%
            genres.forEach( (genre) => {
                let checked = '';

                if ('genres' in pagination.query && (pagination.query.genres == genre || Object.values(pagination.query.genres).includes(genre))) checked ='checked';
            %>
            <div class="form-check">
                <input class="form-check-input" <%=checked%> type="checkbox" name="genres" value="<%=genre%>">
                <label class="form-check-label" for="<%=genre%>">
                    <%=genre%>
                </label>
            </div>
            <% });
            %>
        </div>
        <a role="button" class="collapsed" data-toggle="collapse" href="#collapsegenre" aria-expanded="false" aria-controls="collapsegenre"></a>
        <hr>
        <h4 class="mt-4">Platforms</h4>
        <%
        platforms.forEach((platform) => {
        %>
        <div class="for-check">
            <input class="form-check-input" type="checkbox" name="platforms" value="<%=platform%>">
            <label class="form-check-label" for="<%=platform%>">
                <%=platform%>
            </label>
        </div>
        <%
        })
        %>
        <button type="submit" class="btn btn-primary">Filter</button>
    </form>
</div>

<div class="col-sm-9">

    <h1 class="mt-4">Games</h1>
    <hr>

    <% games.forEach( (game, i) => {
        let gameUrl = "/game?value=" + game._id;
    %>

    <% if (i % 5 === 0) { %>
    <div class="card-deck">
        <% } %>

        <div class="card" style="width: 18rem;">
            <a href="<%= gameUrl %>"><img class="card-img-top" src="<%= game.background_image %>"></a>
            <div class="card-body">
                <a value="cardtitle" href="<%= gameUrl %>"><h5 class="card-title"><%= game.name %></h5></a>
                <p class="card-text">Released <%= (game.released !== null) ? game.released.split('-')[0] : '?'%> | <%= game.reviews_count %> Reviews</p>
                <a href="<%= gameUrl %>" class="btn btn-primary">See More</a>
            </div>
        </div>

        <% if ((i + 1) % 5 === 0) { %>
    </div>
    <br>
    <% } %>

    <% }); %>

    <% include partials/pagination %>

    <% include partials/footer %>
